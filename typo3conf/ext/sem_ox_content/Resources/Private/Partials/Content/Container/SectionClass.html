<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers"
      xmlns:v="http://typo3.org/ns/FluidTYPO3/Vhs/ViewHelpers"
      xmlns:ox="http://typo3.org/ns/Media711/SemOxContent/ViewHelpers" data-namespace-typo3-fluid="true">

<f:section name="Content">
    <f:render section="CssClass" arguments="{_all}" />
    <f:render section="BackgroundImage" arguments="{_all}" />
</f:section>

<!-- CSS class -->
<f:section name="CssClass">
    <v:if stack="{0: {0: data.tx_semcontent_background_color, 1: '!=', 2: '0'},
                  1: 'OR',
                  2: {0: data.layout, 1: '!=', 2: '0'}}">
        class="{v:format.trim(characters: '\0', content: '{data.tx_semcontent_background_color} {data.layout}')
                -> v:format.trim()}"
    </v:if>
</f:section>

<!-- Background image -->
<f:section name="BackgroundImage">
    <f:if condition="{data.tx_semcontent_background_img}">
        <f:if condition="{data.tx_semcontent_background_img} > 1">
            <f:then>
                <f:comment><!-- Render random image --></f:comment>
                {v:resource.record.fal(table: 'tt_content', field: 'tx_semcontent_background_img', record: data)
                 -> v:iterator.random()
                 -> v:variable.set(name: 'backgroundImage')}
            </f:then>
            <f:else>
                <f:comment><!-- Render single image --></f:comment>
                {v:resource.record.fal(table: 'tt_content', field: 'tx_semcontent_background_img', record: data)
                 -> v:iterator.first()
                 -> v:variable.set(name: 'backgroundImage')}
            </f:else>
        </f:if>

        <v:media.exists file="{backgroundImage.url}">
            style="background-image: url({f:uri.image(treatIdAsReference: 1, src: backgroundImage.id)})"
        </v:media.exists>
    </f:if>
</f:section>

<!-- Appearance classes -->
<f:section name="AppearanceClass">
    <ox:iterator.inArray needle="{data.parentgrid_tx_gridelements_backend_layout}" haystack="{settings.deprecatedGrids}">
        <f:then>
            <f:if condition="{data.tx_semoxcontent_section_frame}">
                class="{v:format.trim(characters: '\0', content: '{data.tx_semoxcontent_section_frame}') -> v:format.trim()}"
            </f:if>
        </f:then>
        <f:else>
            <ox:content.appearanceClass data="{data}" />
        </f:else>
    </ox:iterator.inArray>
</f:section>
</html>
